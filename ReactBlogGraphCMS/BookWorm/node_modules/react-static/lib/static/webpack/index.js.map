{"version":3,"sources":["../../../src/static/webpack/index.js"],"names":["resolvedReloadRoutes","reloadWebpackRoutes","devServer","reloadRoutes","webpackConfig","config","stage","sync","require","default","isNode","Error","defaultLoaders","webpackHook","plugins","startDevServer","webpack","devCompiler","intendedPort","port","process","env","PORT","Number","messagePort","chalk","red","green","host","HOST","devServerConfig","hot","disableHostCheck","contentBase","paths","PUBLIC","DIST","publicPath","historyApiFallback","compress","quiet","watchOptions","ignored","before","app","get","req","res","json","next","getSiteData","dev","siteData","status","routes","forEach","routePath","path","encodeURI","route","find","d","getData","data","sharedData","Object","keys","key","sharedHashesByProp","first","console","log","hooks","invalid","tap","name","file","replace","ROOT","done","stats","messages","toJson","isSuccessful","errors","length","warnings","onStart","message","yellow","WebpackDevServer","socket","silent","map","getRoutePath","emit","type","Promise","resolve","reject","listen","err","buildProductionBundles","allWebpackConfigs","run","checkBuildStats","stageStats","buildErrors","hasErrors","buildWarnings","hasWarnings","toString","context","performance","hash","timings","entrypoints","chunkOrigins","chunkModules","colors","bold","stack","details","prodStats","nodeStats","prodStatsJson"],"mappings":"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","sourcesContent":["/* eslint-disable import/no-dynamic-require, react/no-danger, import/no-mutable-exports */\nimport webpack from 'webpack'\nimport formatWebpackMessages from 'react-dev-utils/formatWebpackMessages'\nimport chalk from 'chalk'\nimport WebpackDevServer from 'webpack-dev-server'\nimport io from 'socket.io'\n//\nimport { getStagedRules } from './rules'\nimport { prepareRoutes, outputClientStats } from '../'\nimport {\n  getRoutePath,\n  makeHookReducer,\n  findAvailablePort,\n  time,\n  timeEnd,\n} from '../../utils'\n\nlet resolvedReloadRoutes\nlet reloadWebpackRoutes\n\nlet devServer\n\nconst reloadRoutes = (...args) => {\n  if (!resolvedReloadRoutes) {\n    // Not ready yet, so just wait\n    return\n  }\n  return resolvedReloadRoutes(...args)\n}\n\nexport { reloadRoutes }\n\n// Builds a compiler using a stage preset, then allows extension via\n// webpackConfigurator\nexport function webpackConfig({ config, stage, sync }) {\n  let webpackConfig\n  if (stage === 'dev') {\n    webpackConfig = require('./webpack.config.dev').default({ config })\n  } else if (stage === 'prod') {\n    webpackConfig = require('./webpack.config.prod').default({\n      config,\n    })\n  } else if (stage === 'node') {\n    webpackConfig = require('./webpack.config.prod').default({\n      config,\n      isNode: true,\n    })\n  } else {\n    throw new Error('A stage is required when building a compiler.')\n  }\n\n  const defaultLoaders = getStagedRules({ config, stage })\n\n  const webpackHook = makeHookReducer(config.plugins, 'webpack', { sync })\n\n  return webpackHook(webpackConfig, {\n    config,\n    stage,\n    defaultLoaders,\n  })\n}\n\n// Starts the development server\nexport async function startDevServer({ config }) {\n  if (devServer) {\n    return devServer\n  }\n\n  const devCompiler = webpack(await webpackConfig({ config, stage: 'dev' }))\n\n  // Default to localhost:3000, or use a custom combo if defined in static.config.js\n  // or environment variables\n  const intendedPort =\n    (config.devServer && config.devServer.port) || process.env.PORT || 3000\n  const port = await findAvailablePort(Number(intendedPort))\n  // Find an available port for messages, as long as it's not the devServer port\n  const messagePort = await findAvailablePort(4000, [port])\n  if (intendedPort !== port) {\n    time(\n      chalk.red(\n        `=> Warning! Port ${intendedPort} is not available. Using port ${chalk.green(\n          intendedPort\n        )} instead!`\n      )\n    )\n  }\n  const host =\n    (config.devServer && config.devServer.host) ||\n    process.env.HOST ||\n    'http://localhost'\n\n  const devServerConfig = {\n    hot: true,\n    disableHostCheck: true,\n    contentBase: [config.paths.PUBLIC, config.paths.DIST],\n    publicPath: '/',\n    historyApiFallback: true,\n    compress: false,\n    quiet: true,\n    ...config.devServer,\n    watchOptions: {\n      ignored: 'node_modules',\n      // ignored: new RegExp(`(node_modules|${config.paths.PAGES})`),\n      ...(config.devServer ? config.devServer.watchOptions || {} : {}),\n    },\n    before: app => {\n      // Serve the site data\n      app.get('/__react-static__/getMessagePort', async (req, res) => {\n        res.json({\n          port: messagePort,\n        })\n      })\n\n      app.get('/__react-static__/siteData', async (req, res, next) => {\n        try {\n          const siteData = await config.getSiteData({ dev: true })\n          res.json(siteData)\n        } catch (err) {\n          res.status(500)\n          res.json(err)\n          next(err)\n        }\n      })\n\n      // Since routes may change during dev, this function can rebuild all of the config\n      // routes. It also references the original config when possible, to make sure it\n      // uses any up to date getData callback generated from new or replacement routes.\n      reloadWebpackRoutes = config => {\n        // Serve each routes data\n        config.routes.forEach(({ path: routePath }) => {\n          app.get(\n            `/__react-static__/routeInfo/${encodeURI(\n              routePath === '/' ? '' : routePath\n            )}`,\n            async (req, res, next) => {\n              // Make sure we have the most up to date route from the config, not\n              // an out of dat object.\n              const route = config.routes.find(d => d.path === routePath)\n              try {\n                if (!route) {\n                  throw new Error('Route could not be found!')\n                }\n                // Fetch the data\n                const data = route.getData\n                  ? await route.getData({ route, dev: true })\n                  : {}\n\n                // Auto-include any shared data\n                const sharedData = {}\n                if (route.sharedData) {\n                  Object.keys(route.sharedData).forEach(key => {\n                    sharedData[key] = route.sharedData[key].data\n                  })\n                }\n\n                // Don't use any hashProp, just pass all the data in dev\n                res.json({\n                  ...route,\n                  sharedHashesByProp: {},\n                  data,\n                  sharedData,\n                })\n              } catch (err) {\n                res.status(500)\n                next(err)\n              }\n            }\n          )\n        })\n      }\n\n      reloadWebpackRoutes(config)\n\n      if (config.devServer && config.devServer.before) {\n        config.devServer.before(app)\n      }\n    },\n    port,\n    host,\n  }\n\n  let first = true\n  console.log('=> Building App Bundle...')\n  time(chalk.green('=> [\\u2713] Build Complete'))\n\n  devCompiler.hooks.invalid.tap(\n    {\n      name: 'React-Static',\n    },\n    file => {\n      console.log('=> File changed:', file.replace(config.paths.ROOT, ''))\n      console.log('=> Updating build...')\n      time(chalk.green('=> [\\u2713] Build Updated'))\n    }\n  )\n\n  devCompiler.hooks.done.tap(\n    {\n      name: 'React-Static',\n    },\n    stats => {\n      const messages = formatWebpackMessages(stats.toJson({}, true))\n      const isSuccessful = !messages.errors.length && !messages.warnings.length\n\n      if (isSuccessful) {\n        if (first) {\n          timeEnd(chalk.green('=> [\\u2713] Build Complete'))\n          console.log(\n            chalk.green('=> [\\u2713] App serving at'),\n            `${host}:${port}`\n          )\n        } else {\n          timeEnd(chalk.green('=> [\\u2713] Build Updated'))\n        }\n        if (first && config.onStart) {\n          config.onStart({ devServerConfig })\n        }\n      }\n\n      first = false\n\n      if (messages.errors.length) {\n        console.log(chalk.red('Failed to build! Fix any errors and try again!'))\n        messages.errors.forEach(message => {\n          console.log(message)\n          console.log()\n        })\n      }\n\n      if (messages.warnings.length) {\n        console.log(chalk.yellow('Build complete with warnings.'))\n        console.log()\n        messages.warnings.forEach(message => {\n          console.log(message)\n          console.log()\n        })\n      }\n    }\n  )\n\n  // Start the webpack dev server\n  devServer = new WebpackDevServer(devCompiler, devServerConfig)\n\n  // Start the messages socket\n  const socket = io()\n\n  resolvedReloadRoutes = async paths =>\n    prepareRoutes(config, { dev: true, silent: true }, async config => {\n      if (!paths) {\n        paths = config.routes.map(route => route.path)\n      }\n      paths = paths.map(getRoutePath)\n      reloadWebpackRoutes(config)\n      socket.emit('message', { type: 'reloadRoutes', paths })\n    })\n\n  await new Promise((resolve, reject) => {\n    devServer.listen(port, null, err => {\n      if (err) {\n        return reject(err)\n      }\n      resolve()\n    })\n  })\n\n  // Make sure we start listening on the message port after the dev server.\n  // We do this mostly to appease codesandbox.io, since they autobind to the first\n  // port that opens up for their preview window.\n  socket.listen(messagePort)\n\n  return devServer\n}\n\nexport async function buildProductionBundles({ config }) {\n  const allWebpackConfigs = [\n    await webpackConfig({ config, stage: 'prod' }),\n    await webpackConfig({ config, stage: 'node' }),\n  ]\n  return new Promise(async (resolve, reject) => {\n    webpack(allWebpackConfigs).run(async (err, stats) => {\n      if (err) {\n        console.log(chalk.red(err.stack || err))\n        if (err.details) {\n          console.log(chalk.red(err.details))\n        }\n        return reject(err)\n      }\n\n      stats.toJson('verbose')\n\n      const [prodStats, nodeStats] = stats.stats\n\n      checkBuildStats('prod', prodStats)\n      checkBuildStats('node', nodeStats)\n\n      function checkBuildStats(stage, stageStats) {\n        const buildErrors = stageStats.hasErrors()\n        const buildWarnings = stageStats.hasWarnings()\n\n        if (buildErrors || buildWarnings) {\n          console.log(\n            stageStats.toString({\n              context: config.context,\n              performance: false,\n              hash: false,\n              timings: true,\n              entrypoints: false,\n              chunkOrigins: false,\n              chunkModules: false,\n              colors: true,\n            })\n          )\n          if (buildErrors) {\n            console.log(\n              chalk.red.bold(`\n                => There were ERRORS during the ${stage} build stage! :(\n                => Fix them and try again!\n              `)\n            )\n          } else if (buildWarnings) {\n            console.log(\n              chalk.yellow(`\n=> There were WARNINGS during the ${stage} build stage. Your site will still function, but you may achieve better performance by addressing the warnings above.\n`)\n            )\n          }\n        }\n      }\n\n      const prodStatsJson = prodStats.toJson()\n\n      await outputClientStats(config, prodStatsJson)\n\n      resolve(prodStatsJson)\n    })\n  })\n}\n"],"file":"index.js"}